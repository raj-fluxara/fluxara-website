<!-- Enhanced index.html with immediate cross-platform fixes -->
<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Enhanced viewport and mobile optimization -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=yes" />

  <!-- Prevent zoom on iOS form focus -->
  <meta name="format-detection" content="telephone=no">

  <!-- Better font loading and rendering -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lexend+Deca:wght@300..800&display=swap" rel="stylesheet">

  <!-- Preload critical resources -->
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Lexend+Deca:wght@300..800&display=swap">

  <!-- Enhanced meta tags for better cross-platform support -->
  <title>SustainIQ AI - Turn Industrial Data Into Intelligent Action</title>
  <meta name="description"
    content="SustainIQ AI connects real-time equipment data with manuals and procedures to predict failures, prevent downtime, and maintain compliance automatically." />
  <meta name="author" content="SustainIQ AI" />

  <!-- Open Graph for better social sharing -->
  <meta property="og:title" content="SustainIQ AI - Industrial Data Intelligence" />
  <meta property="og:description"
    content="Transform your industrial data into actionable intelligence with AI-powered solutions." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://sustainiq.ai" />
  <meta property="og:image" content="/sustainiq_logo.svg" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="SustainIQ AI" />
  <meta name="twitter:description" content="Turn Industrial Data Into Intelligent Action" />

  <!-- Apple-specific meta tags -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="SustainIQ AI">

  <!-- Theme colors for better mobile experience -->
  <meta name="theme-color" content="#54de79" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#39d353" media="(prefers-color-scheme: dark)">

  <!-- Favicons with better device support -->
  <link rel="icon" href="/sustainiq_standalone_logo.svg" type="image/svg+xml" />
  <link rel="apple-touch-icon" href="/sustainiq_standalone_logo.svg" />
  <link rel="mask-icon" href="/sustainiq_standalone_logo.svg" color="#54de79" />

  <!-- Critical CSS inlining for better performance -->
  <style>
    /* Critical above-the-fold styles */
    html {
      font-family: 'Lexend Deca', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      line-height: 1.6;
      -webkit-text-size-adjust: 100%;
      -moz-text-size-adjust: 100%;
      text-size-adjust: 100%;
    }

    body {
      margin: 0;
      padding: 0;
      background-color: #fafaf9;
      color: #1a2332;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* Prevent layout shift during font load */
    .font-loading {
      visibility: hidden;
    }

    /* Loading indicator */
    .loading-spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid #f3f3f3;
      border-top: 3px solid #54de79;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    /* Ensure no horizontal scroll on mobile */
    html,
    body {
      overflow-x: hidden;
      max-width: 100vw;
    }

    /* Better touch targets */
    button,
    a {
      min-height: 44px;
      min-width: 44px;
      touch-action: manipulation;
    }
  </style>

  <!-- Performance and compatibility scripts -->
  <script>
    // Font loading optimization
    if ('fonts' in document) {
      document.fonts.ready.then(function () {
        document.body.classList.remove('font-loading');
      });
    } else {
      // Fallback for older browsers
      setTimeout(function () {
        document.body.classList.remove('font-loading');
      }, 3000);
    }

    // Viewport height fix for mobile browsers
    function setVH() {
      let vh = window.innerHeight * 0.01;
      document.documentElement.style.setProperty('--vh', `${vh}px`);
    }

    setVH();
    window.addEventListener('resize', setVH);
    window.addEventListener('orientationchange', function () {
      setTimeout(setVH, 100);
    });

    // Detect and handle reduced motion preference
    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
      document.documentElement.classList.add('reduce-motion');
    }

    // Handle iOS safe area
    if (CSS.supports('padding-top: env(safe-area-inset-top)')) {
      document.documentElement.classList.add('has-safe-area');
    }

    // Basic error handling for cross-browser compatibility
    window.addEventListener('error', function (e) {
      console.error('JavaScript error:', e.error);
    });

    // Prevent zoom on input focus (iOS)
    document.addEventListener('DOMContentLoaded', function () {
      const inputs = document.querySelectorAll('input, textarea, select');
      inputs.forEach(function (input) {
        input.addEventListener('focus', function () {
          document.querySelector('meta[name=viewport]').setAttribute(
            'content',
            'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no'
          );
        });

        input.addEventListener('blur', function () {
          document.querySelector('meta[name=viewport]').setAttribute(
            'content',
            'width=device-width, initial-scale=1.0, user-scalable=yes'
          );
        });
      });
    });
  </script>

  <!-- Structured data for better SEO -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "TechCompany",
      "name": "SustainIQ AI",
      "description": "AI-powered industrial data intelligence platform",
      "url": "https://sustainiq.ai",
      "logo": "https://sustainiq.ai/sustainiq_logo.svg",
      "sameAs": [
        "https://linkedin.com/company/sustainiq-ai"
      ],
      "contactPoint": {
        "@type": "ContactPoint",
        "email": "customer-care@sustainiq.ai",
        "contactType": "customer service"
      },
      "address": {
        "@type": "PostalAddress",
        "streetAddress": "77 Sugar Creek Center Blvd Ste. 600",
        "addressLocality": "Sugar Land",
        "addressRegion": "TX",
        "postalCode": "77478",
        "addressCountry": "US"
      }
    }
    </script>
</head>

<body class="font-loading">
  <!-- Loading indicator for initial page load -->
  <div id="loading-indicator" class="loading-spinner" style="position: fixed; top: 20px; right: 20px; z-index: 9999;">
  </div>

  <!-- Skip to main content for accessibility -->
  <a href="#main-content"
    class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-white focus:text-black focus:rounded">
    Skip to main content
  </a>

  <!-- Main app container -->
  <div id="root"></div>

  <!-- Module script with error handling -->
  <script type="module">
    try {
      import('/src/main.tsx');
    } catch (error) {
      console.error('Failed to load main application:', error);
      document.getElementById('root').innerHTML = `
          <div style="padding: 20px; text-align: center; font-family: system-ui, sans-serif;">
            <h1>SustainIQ AI</h1>
            <p>We're experiencing technical difficulties. Please refresh the page or try again later.</p>
            <button onclick="window.location.reload()" style="padding: 10px 20px; margin-top: 10px; background: #54de79; color: white; border: none; border-radius: 5px; cursor: pointer;">
              Refresh Page
            </button>
          </div>
        `;
    }
  </script>

  <!-- Remove loading indicator once app loads -->
  <script>
    window.addEventListener('load', function () {
      const loadingIndicator = document.getElementById('loading-indicator');
      if (loadingIndicator) {
        loadingIndicator.remove();
      }
    });
  </script>

  <!-- Service Worker for better caching (optional) -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function () {
        navigator.serviceWorker.register('/sw.js').catch(function () {
          // Service worker registration failed - this is optional
        });
      });
    }
  </script>
</body>

</html>